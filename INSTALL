INSTALL

Copyright (c) 2005 Matt Willman
ALL RIGHTS RESERVED

Contact: willman.matt@threepaw.com

This program is free software; you can redistribute it and/or modify it under
the terms of the GNU General Public License as published by the Free Software
Foundation; either version 2 of the License, or (at your option) any later
version.

This program is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with
this program; if not, write to the Free Software Foundation, Inc., 59 Temple
Place, Suite 330, Boston, MA 02111-1307 USA

Initial release
07/2005    MBWillman

FORMATTED FOR 80x25


These instructions assume Linux on the client and server side.  Should be
easily implemented on any of the commercial Unices after you edit to suit your
local configuration.


Prereqs

The following must be installed to use Postchecker

Server

- webserver (Apache, etc)
	http://www.apache.org
- PHP (5.X or 4.X) with GD support compiled in
	http://www.php.net
- jpGraph (2.X for PHP 5.X or 1.X for PHP 4.X)
	http://www.aditus.nu/jpgraph/index.php

Client

- Postfix (any version should work fine)
	http://www.postfix.org



Client Install

Copy queue_counts.sh to your favorite local bin directory.  Edit the POSTCONF
variable to point to your local copy of postconf.

Add the following line to your /etc/services file:

postchecker     7678/tcp                        # PostChecker port

Copy the postchecker.xinetd.sample file into your /etc/xinetd.d directory and
edit the following lines to taste (after renaming the file to postchecker):

only_from       = 127.0.0.1
server          = /path/to/queue_counts.sh

Once everything is in place, you should reload xinetd:

# service xinetd reload

If everything worked OK, run the following command to check your client install.

# telnet localhost postchecker

If you see something like this, you're good to go:

[root@bernard main]# telnet localhost postchecker
Trying 127.0.0.1...
Connected to localhost (127.0.0.1).
Escape character is '^]'.
active:5
deferred:5
corrupt:0
hold:0
Connection closed by foreign host.
[root@bernard main]#

If you don't see something similar to that, check your log files for errors,
and you're configuration files for typos.


Server Install

	These instructions assume you want to use all of the front-ends, and that
you've installed and tested a webserver, PHP, and jpGraph.

	Create a cache directory under your webroot that the user your
webserver is running as can write to.  This directory will hold the graphs
that are generated by PostChecker.  PostChecker doesn't delete the transient
graphs (generated by postchecker_web.php) yet, so for now that's on you.

	The simplest way to start postchecker_server.php on system boot is
to add the following lines to your (S99|rc).local file:

# startup PostChecker server daemon
/path/to/postchecker_server.php &

	Make a directory for PostChecker to live in, /usr/local/postchecker for
example.  The directory should hold the following files:

	- postchecker.cfg
	- postchecker_core.php
	- postchecker_cli.php
	- postchecker_server.php

	While the user that your webserver runs as doesn't need to write to this
directory, it does need to read from it.  The third front-end,
postchecker_web.php, needs to live in a directory under the webroot that you
can see with a browser.

	Edit postchecker.cfg to taste, following the sample instructions.
All the front-ends need to know where to find postchecker_core.php, and 
postchecker_core.php has several options that need to be configured before
it's usable.  Notably the location of your jpGraph installation, and the
directory names for your graph cache directory.

	Finally, postchecker_(cli|server).php need to know where to find the
PHP cli binary.
